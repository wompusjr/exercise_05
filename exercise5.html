<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>exercise 5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="exercise5_files/libs/clipboard/clipboard.min.js"></script>
<script src="exercise5_files/libs/quarto-html/quarto.js"></script>
<script src="exercise5_files/libs/quarto-html/popper.min.js"></script>
<script src="exercise5_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="exercise5_files/libs/quarto-html/anchor.min.js"></script>
<link href="exercise5_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="exercise5_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="exercise5_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="exercise5_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="exercise5_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">exercise 5</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="challenge-one" class="level1">
<h1>Challenge One</h1>
<section id="step-one" class="level2">
<h2 class="anchored" data-anchor-id="step-one">Step One</h2>
<p>After loading the tidyverse package so I could access dplyr and other such functions. I read in IMDB-movies csv file directly from the URL provided and attached the new tibble for easier use.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/IMDB-movies.csv"</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-two" class="level2">
<h2 class="anchored" data-anchor-id="step-two">Step Two</h2>
<p>Using the base R piping function, I filtered the original dataset to only include movies released between 1920 and 1979 before filtering again to only include movies between 60 minutes and 180 minutes (1-3 hours). After that, I used mutate and a series of ifelse sequences to use the startYear column as a reference to create a Decade column for future reference.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span> <span class="fu">filter</span>(startYear <span class="sc">&gt;=</span> <span class="dv">1920</span> <span class="sc">&amp;</span> startYear <span class="sc">&lt;=</span> <span class="dv">1979</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(runtimeMinutes <span class="sc">&gt;=</span> <span class="dv">60</span> <span class="sc">&amp;</span> runtimeMinutes <span class="sc">&lt;=</span> <span class="dv">180</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Decade =</span> <span class="fu">ifelse</span>(startYear <span class="sc">&gt;=</span> <span class="dv">1920</span> <span class="sc">&amp;</span> startYear <span class="sc">&lt;=</span> <span class="dv">1929</span>, <span class="st">"20s"</span>, <span class="fu">ifelse</span>(startYear <span class="sc">&gt;=</span> <span class="dv">1930</span> <span class="sc">&amp;</span> startYear <span class="sc">&lt;=</span> <span class="dv">1939</span>, <span class="st">"30s"</span>, <span class="fu">ifelse</span>(startYear <span class="sc">&gt;=</span> <span class="dv">1940</span> <span class="sc">&amp;</span> startYear <span class="sc">&lt;=</span> <span class="dv">1949</span>, <span class="st">"40s"</span>, <span class="fu">ifelse</span>(startYear <span class="sc">&gt;=</span> <span class="dv">1950</span> <span class="sc">&amp;</span> startYear <span class="sc">&lt;=</span> <span class="dv">1959</span>, <span class="st">"50s"</span>, <span class="fu">ifelse</span>(startYear <span class="sc">&gt;=</span> <span class="dv">1960</span> <span class="sc">&amp;</span> startYear <span class="sc">&lt;=</span> <span class="dv">1969</span>, <span class="st">"60s"</span>, <span class="fu">ifelse</span>(startYear <span class="sc">&gt;=</span> <span class="dv">1970</span> <span class="sc">&amp;</span> startYear <span class="sc">&lt;=</span> <span class="dv">1979</span>, <span class="st">"70s"</span>, <span class="cn">NA</span>)))))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-three" class="level2">
<h2 class="anchored" data-anchor-id="step-three">Step Three</h2>
<p>Using ggplot and facet_wrap, we can visualize the run times of each decade. Each decade has a slight right skew but earlier decades appear to exhibit stronger skew. The 20s seems to be less skewed than the 30s or 40s, but it’s small size suggests a right skew as well. This visual suggests that the average movie generally became slightly longer between decades.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>(p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(<span class="at">x=</span>runtimeMinutes)) <span class="sc">+</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Decade))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="challenge%201.3.png" class="img-fluid"></p>
</section>
<section id="step-four" class="level2">
<h2 class="anchored" data-anchor-id="step-four">Step Four</h2>
<p>Using the pipe function and summarise functions from dplyr, I created the population mean and population standard deviation for movie run-time and saved them into a file called <em>results.</em> List is all follows:</p>
<ul>
<li><p>1920s - <strong>mean:</strong> 96.25658 <strong>sd:</strong> 26.11500</p></li>
<li><p>1930s - <strong>mean:</strong> 90.3 <strong>sd:</strong> 17.27247</p></li>
<li><p>1940s - <strong>mean:</strong> 97.20332 <strong>sd:</strong> 19.11149</p></li>
<li><p>1950s - <strong>mean:</strong> 98.94820 <strong>sd:</strong> 19.19757</p></li>
<li><p>1960s - <strong>mean:</strong> 105.58586 <strong>sd:</strong> 21.22436</p></li>
<li><p>1970s - <strong>mean:</strong> 103.75000 <strong>sd:</strong> 17.95412</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(results <span class="ot">&lt;-</span> d <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Decade) <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_runtime =</span> <span class="fu">mean</span>(runtimeMinutes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_runtime =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((runtimeMinutes <span class="sc">-</span> <span class="fu">mean</span>(runtimeMinutes))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">length</span>(runtimeMinutes))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Looking at the means and standard deviations, this backs up my early assessment of spread. In general, movie times have increased on average; with the 1920s-1930s representing a dip down into shorter movie times. However, this was paired with a wide range from the mean. The 1920s has the largest spread from it’s mean while the 1930s, with the shortest run-time, has the smallest spread. Surprisingly, while spread increased with mean run-time, for most of the decades, the second smallest standard deviation is associated with the decade with the second longest average run-time. Suggesting that during the 1930s and 1970s most movies had average run-times; while in other decades, the mean was less representative.</p>
</section>
<section id="step-five" class="level2">
<h2 class="anchored" data-anchor-id="step-five">Step Five</h2>
<p>Using pipe functions, grouping by decade then slice_sampling 100 random movies, I created a sample that was then able to be summarized through the summarise function. Means and standard deviations to follow;</p>
<ul>
<li><p>1920s - <strong>mean:</strong> 96.51 <strong>sd:</strong> 26.06654</p></li>
<li><p>1930s - <strong>mean:</strong> 92.72 <strong>sd:</strong> 18.92947</p></li>
<li><p>1940s - <strong>mean:</strong> 98.03 <strong>sd:</strong> 19.94308</p></li>
<li><p>1950s - <strong>mean:</strong> 99.16 <strong>sd:</strong> 19.17106</p></li>
<li><p>1960s - <strong>mean:</strong> 105.57 <strong>sd:</strong> 19.22606</p></li>
<li><p>1970s - <strong>mean:</strong> 104.32 <strong>sd:</strong> 19.73966</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(samp_results <span class="ot">&lt;-</span> d<span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Decade) <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">100</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(runtimeMinutes) <span class="sc">|&gt;</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span> (<span class="at">samp_mean_runtime =</span> <span class="fu">mean</span>(runtimeMinutes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">samp_sd_runtime =</span> <span class="fu">sd</span>(runtimeMinutes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Comparing the sample to population, the same trends can be noted although the numbers can stray from the population counterparts by a couple of decimals.</p>
</section>
<section id="step-six" class="level2">
<h2 class="anchored" data-anchor-id="step-six">Step Six</h2>
<p>I calculated the standard error by dividing the samples standard deviation by the square root of the sample size (n=100). I got the following SEs</p>
<ul>
<li><p>1920s - 2.606654</p></li>
<li><p>1930s - 1.892947</p></li>
<li><p>1940s - 1.994308</p></li>
<li><p>1950s - 1.917106</p></li>
<li><p>1960s - 1.922606</p></li>
<li><p>1970s - 1.973966</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(standard_errors <span class="ot">&lt;-</span> samp_results<span class="sc">$</span>samp_sd_runtime<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-seven" class="level2">
<h2 class="anchored" data-anchor-id="step-seven">Step Seven</h2>
<p>Comparing the sample means to the population means, the same trends can be noted, with the 1920s being slightly larger and far more spread out than the 30s, then a period of increasing length and spread before a slight decrease in run-time length and a sharp decrease in spread during the 1970s. That being said, the numbers can stray from the population counterparts by a couple of decimals but fall within the expected ranges given the calculates standard errors.</p>
</section>
<section id="step-eight" class="level2">
<h2 class="anchored" data-anchor-id="step-eight">Step Eight</h2>
<p>To create a sampling distribution, I ran a do() loop* 1000 times that repeated the same sampling process I did to get the first sample, each time estimating the standard deviation and the mean. This produces 1000 estimates of the mean derived from 100 randomly selected movies.</p>
<p>*the do() loop shown produced the most helpful results compared to do(reps) * which caused errors when I attempted to work it. I found this recommendation on StackOverflow and it worked. Apologies.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>samp_results_df <span class="ot">&lt;-</span> <span class="fu">do</span>(<span class="dv">1</span><span class="sc">:</span>reps, {</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">|&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Decade) <span class="sc">|&gt;</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(runtimeMinutes) <span class="sc">|&gt;</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">samp_mean_runtime =</span> <span class="fu">mean</span>(runtimeMinutes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">samp_sd_runtime =</span> <span class="fu">sd</span>(runtimeMinutes, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-nine" class="level2">
<h2 class="anchored" data-anchor-id="step-nine">Step Nine</h2>
<p>I then ran the summarise() function on the sampling distribution to get the mean and standard deviation for each decade with the following results. The means are much closer to the population than the sample and the standard deviation is orders of magnitude smaller than the sample or population</p>
<ul>
<li><p>1920s - <strong>mean:</strong> 96.37257 <strong>sd:</strong> 2.561527</p></li>
<li><p>1930s - <strong>mean:</strong> 90.42237 <strong>sd:</strong> 1.648267</p></li>
<li><p>1940s - <strong>mean:</strong> 97.21887 <strong>sd:</strong> 1.964459</p></li>
<li><p>1950s - <strong>mean:</strong> 98.95217 <strong>sd:</strong> 1.874988</p></li>
<li><p>1960s - <strong>mean:</strong> 105.44335 <strong>sd:</strong> 2.056605</p></li>
<li><p>1970s - <strong>mean:</strong> 103.84133 <strong>sd:</strong> 1.776335</p></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>samp_dist <span class="ot">&lt;-</span> samp_dist_df <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Decade) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">samp_dist_mean_runtime =</span> <span class="fu">mean</span>(samp_mean_runtime),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">samp_dist_sd_runtime =</span> <span class="fu">sd</span>(samp_mean_runtime)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>(p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(samp_dist_df, <span class="fu">aes</span>(<span class="at">x =</span> samp_mean_runtime)) <span class="sc">+</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> Decade))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Plotting the sampling distribution shows that each decade exhibits a more normal distribution with considerably less skew. This is most apparent for the 1920s, which better illustrates the mean visually.<img src="challenge%201.9.png" class="img-fluid"></p>
</section>
<section id="step-ten" class="level2">
<h2 class="anchored" data-anchor-id="step-ten">Step Ten</h2>
<p>Comparing the three estimates of standard errors we’ve been provided the SE derived from a single sample is about a decimal place off from the standard deviations of each decade in the sampling distribution. Both of these are much smaller than the population standard deviations, with decimals usually one place further up than their population standard deviation counterpart. Otherwise, the numbers are still pretty similar and all of them convey the same trend.</p>
</section>
</section>
<section id="challenge-two" class="level1">
<h1>Challenge Two</h1>
<section id="step-one-1" class="level2">
<h2 class="anchored" data-anchor-id="step-one-1">Step One</h2>
<p>After loading the tidyverse package so I could access dplyr and other such functions. I read i the Zombies csv file directly from the URL provided and attached the new tibble for easier use.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://raw.githubusercontent.com/difiore/ada-datasets/main/zombies.csv"</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-two-1" class="level2">
<h2 class="anchored" data-anchor-id="step-two-1">Step Two</h2>
<p>I used the summarise function to calculate the mean and standard deviation for the population;</p>
<ul>
<li><p>Height in inches - <strong>mean:</strong> 67.6301 <strong>sd:</strong> 4.30797</p></li>
<li><p>Weight in pounds - <strong>mean:</strong> 143.9075 <strong>sd:</strong> 18.39186</p></li>
<li><p>Zombies Killed per Person- <strong>mean:</strong> 2.992 <strong>sd:</strong> 1.747551</p></li>
<li><p>Years of Education per Person - <strong>mean:</strong> 2.996 <strong>sd:</strong> 1.675704</p></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(z_result <span class="ot">&lt;-</span> z <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">mean_height =</span> <span class="fu">mean</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">sd_height =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((height <span class="sc">-</span> <span class="fu">mean</span>(height))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">length</span>(height)),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">mean_weight =</span> <span class="fu">mean</span>(weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">sd_weight =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((weight <span class="sc">-</span> <span class="fu">mean</span>(weight))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">length</span>(weight)),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">mean_zkills =</span> <span class="fu">mean</span>(zombies_killed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">sd_zkills =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((zombies_killed <span class="sc">-</span> <span class="fu">mean</span>(zombies_killed))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">length</span>(zombies_killed)),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">mean_ed =</span> <span class="fu">mean</span>(years_of_education, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">sd_ed =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>((years_of_education <span class="sc">-</span> <span class="fu">mean</span>(years_of_education, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> (<span class="fu">length</span>(years_of_education) <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(years_of_education))))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-three-1" class="level2">
<h2 class="anchored" data-anchor-id="step-three-1">Step Three</h2>
<p>I used the the ggpubr library and its ggarrange function to condense the four histograms into a single plot summarizing the data by gender.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggpubr"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(z, <span class="fu">aes</span>(<span class="at">y =</span> height)) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>)<span class="sc">+</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> gender)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>pw <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(z, <span class="fu">aes</span>(<span class="at">y =</span> weight)) <span class="sc">+</span> </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>)<span class="sc">+</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> gender)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>pz <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(z, <span class="fu">aes</span>(<span class="at">y =</span> zombies_killed)) <span class="sc">+</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>)<span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> gender)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>pe <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(z, <span class="fu">aes</span>(<span class="at">y =</span> years_of_education)) <span class="sc">+</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>)<span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> gender)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>(stepthree <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(ph, pw, pz, pe,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="cn">NA</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="oops!.png" class="img-fluid"></p>
</section>
<section id="step-four-1" class="level2">
<h2 class="anchored" data-anchor-id="step-four-1">Step Four</h2>
<p>I did a similar procedure to generate the scatterplots for height and weight by age.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(ph2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(z, <span class="fu">aes</span>(age, height, <span class="at">color=</span>gender)) <span class="sc">+</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Female"</span> <span class="ot">=</span> <span class="st">"purple"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Male"</span><span class="ot">=</span><span class="st">"green"</span>)))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>(pw2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(z, <span class="fu">aes</span>(age, weight, <span class="at">color=</span>gender)) <span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Female"</span> <span class="ot">=</span> <span class="st">"purple"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Male"</span><span class="ot">=</span><span class="st">"green"</span>)))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>(stepfour <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(ph2,pw2,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="cn">NA</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">nrow =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="challenge2.4.png" class="img-fluid"></p>
<p>Looking at the first plot, height seems to increase across both genders as age increases and males tend to be taller across all ages on average. The second plot shows less strong correlation between age and weight; however, males tend to weigh more on average than females.</p>
</section>
<section id="step-five-1" class="level2">
<h2 class="anchored" data-anchor-id="step-five-1">Step Five</h2>
<p>To check for a normal distribution, I created histograms and q-q plots. The latter had to be combined using par() as ggarrange got mad at me for trying to combine them.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ph3norm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(z, <span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>pw3norm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(z, <span class="fu">aes</span>(<span class="at">x =</span> weight)) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>pz3norm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(z, <span class="fu">aes</span>(<span class="at">x =</span> zombies_killed)) <span class="sc">+</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>pe3norm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(z, <span class="fu">aes</span>(<span class="at">x =</span> years_of_education)) <span class="sc">+</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>(<span class="fu">ggarrange</span>(ph3norm,pw3norm,pz3norm,pe3norm,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="cn">NA</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(z<span class="sc">$</span>height, <span class="at">main =</span> <span class="st">"Height - QQ"</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(z<span class="sc">$</span>height, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(z<span class="sc">$</span>weight, <span class="at">main =</span> <span class="st">"Weight - QQ"</span>)<span class="sc">+</span> </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(z<span class="sc">$</span>weight, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(z<span class="sc">$</span>zombies_killed, <span class="at">main =</span> <span class="st">"Zombies Killed - QQ"</span>)<span class="sc">+</span> </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(z<span class="sc">$</span>zombies_killed, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(z<span class="sc">$</span>years_of_education, <span class="at">main =</span> <span class="st">"Years of Education - QQ"</span>)<span class="sc">+</span> </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(z<span class="sc">$</span>years_of_education, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="challenge%205.21.png" class="img-fluid"></p>
<p><img src="challenge2.52.png" class="img-fluid">Looking at the histograms, it’s clear that zombies killed and years of education don’t follow normal distributions. Comparing this to the Q-Q plots, I’d posit that they may be beta distributions but I’m not sure.</p>
</section>
<section id="step-six-1" class="level2">
<h2 class="anchored" data-anchor-id="step-six-1">Step Six</h2>
<p>To accomplish this task, I created the CI function to create confidence intervals then sampled from the base to create means and standard deviations before using those to calculate standard errors and confidence intervals</p>
<ul>
<li><p>Height in inches - <strong>mean:</strong> 66.86607 <strong>sd:</strong> 3.714427 <strong>se:</strong> 1.313248 <strong>CI:</strong> <em>lower</em> 64.29215 <em>upper</em> 69.43999</p></li>
<li><p>Weight in pounds - <strong>mean:</strong> 141.3507 <strong>sd:</strong> 17.8264 <strong>se:</strong> 6.302585 <strong>CI:</strong> <em>lower</em> 128.9978 <em>upper</em> 153.7035</p></li>
<li><p>Zombies Killed per Person- <strong>mean:</strong> 2.76 <strong>sd:</strong> 1.597958 <strong>se:</strong> 0.5649634 <strong>CI:</strong> <em>lower</em> 1.652692 <em>upper</em> 3.867308</p></li>
<li><p>Years of Education per Person - <strong>mean:</strong> 3.08 <strong>sd:</strong> 1.936123 <strong>se:</strong> 0.6845228 <strong>CI:</strong> <em>lower</em> 1.73836 <em>upper</em> 4.42164</p></li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y, <span class="at">level =</span> <span class="fl">0.95</span>) {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> level</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> (alpha<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> y</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ci)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>(sampleone <span class="ot">&lt;-</span> z<span class="sc">|&gt;</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">50</span>) <span class="sc">|&gt;</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span> (<span class="at">samp_mean_height =</span> <span class="fu">mean</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">samp_sd_height =</span> <span class="fu">sd</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">samp_mean_weight =</span> <span class="fu">mean</span>(weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">samp_sd_weight =</span> <span class="fu">sd</span>(weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">samp_mean_zkilled =</span> <span class="fu">mean</span>(zombies_killed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">samp_sd_zkilled =</span> <span class="fu">sd</span>(zombies_killed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">samp_mean_ed =</span> <span class="fu">mean</span>(years_of_education, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">samp_sd_ed =</span> <span class="fu">sd</span>(years_of_education, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>(se_height <span class="ot">&lt;-</span> sampleone<span class="sc">$</span>samp_sd_height<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(sampleone)))</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>(ci_height <span class="ot">&lt;-</span> <span class="fu">CI</span>(sampleone<span class="sc">$</span>samp_mean_height,se_height))</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>(se_weight <span class="ot">&lt;-</span> sampleone<span class="sc">$</span>samp_sd_weight<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(sampleone)))</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>(ci_weight <span class="ot">&lt;-</span> <span class="fu">CI</span>(sampleone<span class="sc">$</span>samp_mean_weight,se_weight))</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>(se_zkilled <span class="ot">&lt;-</span> sampleone<span class="sc">$</span>samp_sd_zkilled<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(sampleone)))</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>(ci_zkilled <span class="ot">&lt;-</span> <span class="fu">CI</span>(sampleone<span class="sc">$</span>samp_mean_zkilled,se_zkilled))</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>(se_ed <span class="ot">&lt;-</span> sampleone<span class="sc">$</span>samp_sd_ed<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">length</span>(sampleone)))</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>(ci_ed <span class="ot">&lt;-</span> <span class="fu">CI</span>(sampleone<span class="sc">$</span>samp_mean_ed,se_ed))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-seven-1" class="level2">
<h2 class="anchored" data-anchor-id="step-seven-1">Step Seven</h2>
<p>To accomplish this task, I used the map_dfr function from purrr since otherwise it wouldn’t save as a dataframe then I combined the new samples to the old sample to create the sampling distribution which had the following details;</p>
<ul>
<li><p>Height in inches - <strong>mean:</strong> 67.65074 <strong>sd:</strong> 0.605038</p></li>
<li><p>Weight in pounds - <strong>mean:</strong> 144.002 <strong>sd:</strong> 2.572191</p></li>
<li><p>Zombies Killed per Person- <strong>mean:</strong> 2.9914 <strong>sd:</strong> 0.2477923</p></li>
<li><p>Years of Education per Person - <strong>mean:</strong> 2.9774 <strong>sd:</strong> 0.2057203</p></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="dv">199</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>(samp_dist_z <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(<span class="dv">1</span><span class="sc">:</span>reps, <span class="sc">~</span> {</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  z <span class="sc">|&gt;</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">samp_mean_height =</span> <span class="fu">mean</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">samp_sd_height =</span> <span class="fu">sd</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">samp_mean_weight =</span> <span class="fu">mean</span>(weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">samp_sd_weight =</span> <span class="fu">sd</span>(weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">samp_mean_zkilled =</span> <span class="fu">mean</span>(zombies_killed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">samp_sd_zkilled =</span> <span class="fu">sd</span>(zombies_killed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">samp_mean_ed =</span> <span class="fu">mean</span>(years_of_education, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">samp_sd_ed =</span> <span class="fu">sd</span>(years_of_education, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>samp_dist_z <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(sampleone, samp_dist_z)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>(samp_dist_z_result <span class="ot">&lt;-</span> samp_dist_z <span class="sc">|&gt;</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">s_mean_height =</span> <span class="fu">mean</span>(samp_mean_height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">s_sd_height =</span> <span class="fu">sd</span>(samp_mean_height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">s_mean_weight =</span> <span class="fu">mean</span>(samp_mean_weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">s_sd_weight =</span> <span class="fu">sd</span>(samp_mean_weight, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">s_mean_zkilled =</span> <span class="fu">mean</span>(samp_mean_zkilled, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">s_sd_zkilled =</span> <span class="fu">sd</span>(samp_mean_zkilled, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">s_mean_ed =</span> <span class="fu">mean</span>(samp_mean_ed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">s_sd_ed =</span> <span class="fu">sd</span>(samp_mean_ed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="step-eight-1" class="level2">
<h2 class="anchored" data-anchor-id="step-eight-1">Step Eight</h2>
<p>When plotting these distributions, I basically repeated step five</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ph4norm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(samp_dist_z, <span class="fu">aes</span>(<span class="at">x =</span> samp_mean_height)) <span class="sc">+</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>pw4norm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(samp_dist_z, <span class="fu">aes</span>(<span class="at">x =</span> samp_mean_weight)) <span class="sc">+</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>pz4norm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(samp_dist_z, <span class="fu">aes</span>(<span class="at">x =</span> samp_mean_zkilled)) <span class="sc">+</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>pe4norm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(samp_dist_z, <span class="fu">aes</span>(<span class="at">x =</span> samp_mean_ed)) <span class="sc">+</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"lightblue"</span>, <span class="at">fill =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>(<span class="fu">ggarrange</span>(ph4norm,pw4norm,pz4norm,pe4norm,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="cn">NA</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>))</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(samp_dist_z<span class="sc">$</span>samp_mean_height, <span class="at">main =</span> <span class="st">"Height - QQ"</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(samp_dist_z<span class="sc">$</span>samp_mean_height, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(samp_dist_z<span class="sc">$</span>samp_mean_weight, <span class="at">main =</span> <span class="st">"Weight - QQ"</span>)<span class="sc">+</span> </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqline</span>(samp_dist_z<span class="sc">$</span>samp_mean_weight, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(samp_dist_z<span class="sc">$</span>samp_mean_zkilled, <span class="at">main =</span> <span class="st">"Zombies Killed - QQ"</span>)<span class="sc">+</span> </span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqline</span>(samp_dist_z<span class="sc">$</span>samp_mean_zkilled, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(samp_dist_z<span class="sc">$</span>samp_mean_ed, <span class="at">main =</span> <span class="st">"Years of Education - QQ"</span>)<span class="sc">+</span> </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qqline</span>(z<span class="sc">$</span>samp_dist_z<span class="sc">$</span>samp_mean_ed, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><img src="challenge2.81.png" class="img-fluid"></p>
<p><img src="challenge%202.82.png" class="img-fluid"></p>
<p>These show pretty clearly that the non-normal distributions (Zombies Killed and Years of Education) have normalized as sampling distributions.</p>
</section>
<section id="step-nine-1" class="level2">
<h2 class="anchored" data-anchor-id="step-nine-1">Step Nine</h2>
<p>I used the quantile function on the sampling distribution to get the confidence intervals for each of the variables. They are as follows;</p>
<ul>
<li><p>Height in inches - <em>lower</em> 66.48512 <em>upper</em> 66.92798</p></li>
<li><p>Weight in pounds - <em>lower</em> 139.6550 <em>upper</em> 141.0724</p></li>
<li><p>Zombies Killed per Person-<em>lower</em> 2.5595 <em>upper</em> 2.7000</p></li>
<li><p>Years of Education per Person -<em>lower</em> 2.60 <em>upper</em> 2.72</p></li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(s_ci_height <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samp_dist_z<span class="sc">$</span>samp_mean_height,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.0975</span>)))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>(s_ci_weight <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samp_dist_z<span class="sc">$</span>samp_mean_weight,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.0975</span>)))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>(s_ci_zkilled <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samp_dist_z<span class="sc">$</span>samp_mean_zkilled,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.0975</span>)))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>(s_ci_ed <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samp_dist_z<span class="sc">$</span>samp_mean_ed,<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.0975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This appear as far more narrow ranges around the mean than from a single sample.</p>
</section>
<section id="step-ten-1" class="level2">
<h2 class="anchored" data-anchor-id="step-ten-1">Step Ten</h2>
<p>Finally, I used the bootstrapping procedure laid out in class and on the class page to bootstrap 1000 samples and generate CIs for each of the variables. They are as follows.</p>
<ul>
<li><p>Height in inches - <em>lower</em> 67.36860 <em>upper</em> 67.45841</p></li>
<li><p>Weight in pounds - <em>lower</em> 142.7764 <em>upper</em> 143.1599</p></li>
<li><p>Zombies Killed per Person-<em>lower</em> 2.884 <em>upper</em> 2.921</p></li>
<li><p>Years of Education per Person -<em>lower</em> 2.892975 <em>upper</em> 2.925000</p></li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>n_boot <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="do">##height</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>hboot <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> n_boot)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>n_height <span class="ot">&lt;-</span> <span class="fu">length</span>(z<span class="sc">$</span>height)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_boot) {</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  hboot[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sample</span>(z<span class="sc">$</span>height, n_height, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>(ci_hboot <span class="ot">&lt;-</span> <span class="fu">quantile</span>(hboot, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.0975</span>)))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="do">##weight</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>wboot <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> n_boot)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>n_weight <span class="ot">&lt;-</span> <span class="fu">length</span>(z<span class="sc">$</span>weight)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_boot) {</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  wboot[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sample</span>(z<span class="sc">$</span>weight, n_weight, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>(ci_wboot <span class="ot">&lt;-</span> <span class="fu">quantile</span>(wboot, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.0975</span>)))</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="do">##zkilled</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>zboot <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> n_boot)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>n_zk <span class="ot">&lt;-</span> <span class="fu">length</span>(z<span class="sc">$</span>zombies_killed)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_boot) {</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  zboot[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sample</span>(z<span class="sc">$</span>zombies_killed, n_zk, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>(ci_zboot <span class="ot">&lt;-</span> <span class="fu">quantile</span>(zboot, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.0975</span>)))</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="do">##ed</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>edboot <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> n_boot)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>n_ed <span class="ot">&lt;-</span> <span class="fu">length</span>(z<span class="sc">$</span>years_of_education)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_boot) {</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  edboot[[i]] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sample</span>(z<span class="sc">$</span>years_of_education, n_ed, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>(ci_edboot <span class="ot">&lt;-</span> <span class="fu">quantile</span>(edboot, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.0975</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This appear as EVEN more narrow ranges around the mean than from a single sample.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>